<% include header.ejs %>
<link rel="stylesheet" href="/css/schedule.css">

<div id=container>
    
    <a href="/schedule/<%= id %>/view"><div class="button cancel">Cancel</div></a>
    
    <a href="/schedule/<%= id %>/go"><div class="button go">Confirm</div></a>
    
    <div id=timer></div>

    <table class="ui celled striped table">
        <thead>
            <tr>
                <th class=itemname>Item Name</th>
                <th class="right aligned collapsing">Finish By</th>
            </tr>
        </thead>

        <tbody id="tableBody">
            
        </tbody>
    </table>
    
</div>

<script>
    
    var content = "";

    function pad (str, max) {
        str = str.toString();
        return str.length < max ? pad("0" + str, max) : str;
    }
    
    var updateTimes = () => {
        content = "";
        var schedule = <%- JSON.stringify(schedule) %>
        times = getTimes(schedule);
        for (var i=0; i<times.length; i++) {
            content += `<tr><td>${times[i][0]}</td><td class="right aligned collapsing">${times[i][1]}</td></tr>`;
        }
    }

    var wait = () => {
        updateTimes();
        document.getElementById("tableBody").innerHTML = content;
        secs--;
        document.getElementById("timer").innerHTML = secs + "s"
        setTimeout(wait, 1000);
    }

var secs = 100;
updateTimes();
document.getElementById("tableBody").innerHTML = content;
wait();
    
</script>